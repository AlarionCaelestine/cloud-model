# CloudModel

## Описание проекта

CloudModel - это комплексная реализация гравитационной модели газовых облаков в астрофизике на языке программирования Julia. Модель позволяет рассчитывать гравитационный потенциал, плотность и распределение массы в газовом облаке с использованием итеративных численных методов.

## Физические основы

Модель основана на следующих физических принципах и уравнениях:

- **Уравнение Пуассона** для гравитационного потенциала: 
  ∇²Φ = 4πGρ
  
- **Барометрическое уравнение** для распределения плотности: 
  ρ = ρ₀·exp(-Φμ/RT)
  
- **Итеративное решение** связанной системы уравнений:
  1. Решение уравнения Пуассона с текущей плотностью
  2. Обновление распределения плотности по барометрическому закону
  3. Пересчет общей массы облака

- **Фундаментальные константы**:
  - Гравитационная постоянная G = 6.67×10⁻¹¹ м³/кг/с²
  - Газовая постоянная R = 8.31 Дж/моль/К

## Основные возможности

- Решение уравнения Пуассона для гравитационных потенциалов методом Якоби
- Расчет барометрического распределения плотности с экспоненциальным профилем
- Работа с физическими единицами измерения через пакеты Unitful.jl и UnitfulAstro.jl
- Многопоточные вычисления для ускорения расчетов на многоядерных системах
- Комплексная визуализация результатов в 1D, 2D и 3D представлениях
- Удобный интерфейс запуска из командной строки с настраиваемыми параметрами

## Установка и требования

### Системные требования

Для работы с проектом требуется:
- Julia версии 1.6 или выше
- Многоядерный процессор для эффективного использования многопоточности

### Установка зависимостей

```bash
# Установка необходимых пакетов
julia -e 'using Pkg; Pkg.add(["Unitful", "UnitfulAstro", "GLMakie", "StaticArrays"])'
```

### Зависимости

Проект использует следующие пакеты Julia:
- `Unitful` - работа с физическими единицами измерения
- `UnitfulAstro` - астрономические единицы измерения
- `GLMakie` - визуализация и построение графиков
- `LinearAlgebra` - векторные и матричные операции
- `StaticArrays` - эффективные статические массивы
- `Base.Threads` - многопоточные вычисления

## Использование

### Основные функции

```julia
using CloudModel

# Запуск симуляции с параметрами по умолчанию
state, constants = run_simulation()

# Запуск симуляции с пользовательскими параметрами
state, constants = run_simulation(
    n_iterations=2000,
    size=60.0,
    N=100,
    T=30.0,
    rho_0=5e-17,
    mu=2.35e-3,
    verbose=true
)

# Визуализация результатов
visualize_results(state, constants)

# Извлечение 2D среза из 3D данных
slice = extract_2d_slice(state, 3, nothing)  # срез в плоскости XY через центр
```

### Параметры симуляции

Вы можете настроить следующие параметры при запуске симуляции:

| Параметр | Описание | Тип | Значение по умолчанию |
|----------|----------|-----|----------------------|
| `n_iterations` | Количество итераций | Int | 1000 |
| `size` | Размер области в а.е. | Float64 | 40.0 |
| `N` | Количество точек сетки по каждому измерению | Int | 50 |
| `T` | Температура облака в К | Float64 | 50.0 |
| `rho_0` | Начальная плотность в кг/m³ | Float64 | 6e-17 |
| `mu` | Молекулярная масса в кг/моль | Float64 | 2.35e-3 |
| `verbose` | Выводить информацию о ходе симуляции | Bool | true |

### Запуск из командной строки

Вы можете запустить симуляцию напрямую из командной строки:

```bash
julia cloud_model.jl --iterations=1000 --N=50 --size=40
```

Доступные аргументы командной строки:
- `--iterations=N` - количество итераций
- `--N=N` - размер сетки
- `--size=N` - размер области в астрономических единицах

## Визуализация результатов

Модель предоставляет комплексную визуализацию результатов, включающую:

1. **1D графики** - распределение плотности и потенциала вдоль оси X 
2. **2D тепловые карты** - срезы поля плотности и потенциала в плоскости XY
3. **3D контурные графики** - изоповерхности плотности и потенциала на разных уровнях

Результаты автоматически сохраняются в формате PNG с указанием параметров симуляции в имени файла.

## Примеры использования

### Стандартная симуляция

```julia
using CloudModel

# Стандартная симуляция с параметрами по умолчанию
state, constants = run_simulation()

# Визуализация результатов
visualize_results(state, constants)
```

### Высокоточная симуляция

```julia
using CloudModel

# Симуляция с высоким разрешением и большим числом итераций
state, constants = run_simulation(
    n_iterations=5000,    # больше итераций для точности
    N=100,                # более детальная сетка
    size=80.0,            # больший размер области
    T=30.0,               # более холодное облако
    verbose=true          # вывод прогресса
)

# Визуализация с пользовательскими параметрами
visualize_results(
    state, constants,
    n_iterations=5000,
    output_prefix="high_res_cloud"
)
```

## Применение в астрофизике

Эта модель может быть использована для различных астрофизических исследований:

- **Моделирование протозвездных облаков** - изучение начальных стадий образования звезд
- **Анализ стабильности газовых облаков** - исследование условий коллапса и фрагментации
- **Изучение распределения массы** - исследование профилей плотности в газовых облаках
- **Образование планетарных систем** - моделирование ранних этапов формирования планет

## Ограничения и дальнейшее развитие

### Текущие ограничения

- Предполагается изотермическое состояние газа
- Не учитывается вращение облака
- Не моделируются магнитные поля
- Не учитывается турбулентность и динамические эффекты

### Планируемые улучшения

- **Расширение физики**:
  - Добавление магнитных полей
  - Учет вращения облака
  - Адаптивное разрешение сетки
  - Неизотермические расчеты

- **Улучшения производительности**:
  - Использование GPU для ускорения вычислений
  - Адаптивная сетка для повышения точности в областях интереса
  - Альтернативные численные методы (метод мультипольного разложения)

- **Дополнительная функциональность**:
  - Анимация эволюции облака во времени
  - Экспорт данных в различные форматы (HDF5, VTK)
  - Веб-интерфейс для запуска и визуализации

## Лицензия

Проект распространяется под лицензией MIT.

